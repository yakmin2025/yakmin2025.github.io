<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìŒì‹ìœ¼ë¡œ ì¶”ì²œë°›ëŠ” ë¡œë˜ 1ë“± ë²ˆí˜¸ ğŸ€</title>

  <meta property="og:image" content="https://yakmin2025.github.io/thumbnail.png" />
  <meta property="og:title" content="AI ìŒì‹ ë¡œë˜ ğŸ€" />
  <meta property="og:description" content="ì¢‹ì•„í•˜ëŠ” ìŒì‹ì„ ëˆ„ë¥´ë©´ ì˜¤ëŠ˜ì˜ ë¡œë˜ ë²ˆí˜¸ë¥¼ ì¶”ì²œí•´ë“œë ¤ìš”!" />
  <meta property="og:url" content="https://yakmin2025.github.io/" />

  <style>
    body { font-family: "Pretendard", sans-serif; text-align:center; background:#fff9f6; margin:0; }
    h1 { margin-top:30px; }
    .food-btn { border:none; border-radius:50%; margin:8px; width:65px; height:65px; font-size:1.8em; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
    .numbers { margin:25px auto; display:flex; justify-content:center; flex-wrap:wrap; gap:10px; }
    .ball { width:42px; height:42px; border-radius:50%; line-height:42px; font-weight:bold; color:#fff; }
    .actions, .sns { margin:15px; }
    .action-btn { border:none; background:#ffdca8; border-radius:20px; padding:10px 16px; cursor:pointer; }
    .history { max-width:400px; margin:25px auto; background:#fff; padding:15px; border-radius:12px; text-align:left; box-shadow:0 2px 6px rgba(0,0,0,0.05); }
  </style>

  <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>
</head>
<body>
  <h1>ğŸ€ ìŒì‹ìœ¼ë¡œ ì¶”ì²œë°›ëŠ” ë¡œë˜ 1ë“± ë²ˆí˜¸ ğŸ€</h1>

  <div class="food-container">
    <button class="food-btn">ğŸ£</button>
    <button class="food-btn">ğŸ•</button>
    <button class="food-btn">ğŸ—</button>
    <button class="food-btn">ğŸ”</button>
    <button class="food-btn">ğŸ™</button>
    <button class="food-btn">ğŸœ</button>
    <button class="food-btn">ğŸ²</button>
    <button class="food-btn">ğŸ¥“</button>
    <button class="food-btn">ğŸ¥©</button>
  </div>

  <div id="numbers" class="numbers">
    <div class="placeholder">ğŸ¯ ìŒì‹ ì„ íƒ ì‹œ ë²ˆí˜¸ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
  </div>

  <div class="actions" id="actions" style="display:none;">
    <button class="action-btn" id="save">ì˜¤ëŠ˜ì˜ ë²ˆí˜¸ ì €ì¥</button>
  </div>

  <div class="sns" id="sns" style="display:none;">
    <button class="action-btn" id="shareKakao">ğŸ—¨ï¸ ì¹´ì¹´ì˜¤í†¡ ê³µìœ </button>
  </div>

  <div class="history" id="history">
    <h3>ğŸ“œ ì˜¤ëŠ˜ì˜ ë²ˆí˜¸ ëª©ë¡</h3>
    <ul id="historyList"></ul>
  </div>

  <script>
    Kakao.init("0fa08a279fdde2a96db99f7d26446e9d");
    const foods = ["ì´ˆë°¥","í”¼ì","ì¹˜í‚¨","í–„ë²„ê±°","ê¹€ë°¥","ë¼ë©´","êµ­ë°¥","ì‚¼ê²¹ì‚´","ìŠ¤í…Œì´í¬"];
    const colors = ["#f44336","#ff9800","#ffeb3b","#4caf50","#2196f3","#9c27b0"];
    let selectedFood = null, numbers = [];

    document.querySelectorAll(".food-btn").forEach((btn, idx) => {
      btn.addEventListener("click", () => {
        selectedFood = foods[idx];
        numbers = generateNumbers(selectedFood);
        showNumbers(numbers);
      });
    });

    function generateNumbers(food) {
      const seed = food + new Date().toISOString().slice(0,10);
      let hash = 0; for (let i = 0; i < seed.length; i++) hash = seed.charCodeAt(i) + ((hash<<5)-hash);
      const nums = [];
      while (nums.length < 6) {
        hash = (hash * 9301 + 49297) % 233280;
        const num = Math.floor((hash / 233280) * 45) + 1;
        if (!nums.includes(num)) nums.push(num);
      }
      return nums;
    }

    function showNumbers(nums) {
      const nDiv = document.getElementById("numbers");
      nDiv.innerHTML = "";
      nums.forEach((n,i)=>{
        const b = document.createElement("div");
        b.className="ball";
        b.style.background=colors[i%colors.length];
        b.textContent=n;
        nDiv.appendChild(b);
      });
      document.getElementById("actions").style.display="block";
      document.getElementById("sns").style.display="block";
    }

    document.getElementById("save").addEventListener("click", async ()=>{
      if(!selectedFood||numbers.length===0)return;
      const today=new Date().toISOString().slice(0,10);
      const record={date:today,food:selectedFood,nums:[...numbers]};
      await addRecord(record);
      renderHistory();
    });

    function openDB(){
      return new Promise((res)=>{
        const req=indexedDB.open("LottoDB",1);
        req.onupgradeneeded=(e)=>e.target.result.createObjectStore("records",{autoIncrement:true});
        req.onsuccess=(e)=>res(e.target.result);
      });
    }

    async function addRecord(record){
      const db=await openDB();
      const tx=db.transaction("records","readwrite");
      tx.objectStore("records").add(record);
      tx.oncomplete=()=>{
        const saved=JSON.parse(localStorage.getItem("lottoRecords")||"[]");
        saved.push(record);
        localStorage.setItem("lottoRecords",JSON.stringify(saved));
      };
    }

    async function renderHistory(){
      const list=document.getElementById("historyList");
      list.innerHTML="";
      const db=await openDB();
      const tx=db.transaction("records","readonly");
      const store=tx.objectStore("records");
      const req=store.getAll();
      req.onsuccess=()=>{
        const records=req.result.length?req.result:JSON.parse(localStorage.getItem("lottoRecords")||"[]");
        records.reverse().forEach(r=>{
          const li=document.createElement("li");
          li.textContent=`${r.date} - ${r.food}: ${r.nums.join(", ")}`;
          list.appendChild(li);
        });
      };
    }

    document.getElementById("shareKakao").addEventListener("click",()=>{
      Kakao.Link.sendDefault({
        objectType:'feed',
        content:{
          title:'AI ìŒì‹ ë¡œë˜ ğŸ€',
          description:'ì˜¤ëŠ˜ì˜ ìŒì‹ìœ¼ë¡œ ë¡œë˜ ë²ˆí˜¸ ì¶”ì²œë°›ê¸°!',
          imageUrl:'https://yakmin2025.github.io/thumbnail.png',
          link:{mobileWebUrl:'https://yakmin2025.github.io/',webUrl:'https://yakmin2025.github.io/'}
        }
      });
    });

    renderHistory();
  </script>
</body>
</html>
